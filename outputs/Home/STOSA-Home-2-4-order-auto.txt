Namespace(data_dir='./data/Features/Home/', output_dir='outputs/Home', data_name='reviews_Home', do_eval=False, ckp=10, patience=10, model_name='STOSA', hidden_size=256, num_hidden_layers=1, num_attention_heads=4, hidden_act='gelu', attention_probs_dropout_prob=0.0, hidden_dropout_prob=0.3, initializer_range=0.02, max_seq_length=100, distance_metric='wasserstein', pvn_weight=0.005, kernel_param=1.0, image_emb_path='data/Features/Home/clip_image_features_Home.pt', text_emb_path='data/Features/Home/clip_text_features_Home.pt', mm_emb_dim=512, is_use_mm=True, is_use_text=False, is_use_image=False, pretrain_emb_dim=512, is_use_cross=True, num_shared_experts=2, num_specific_experts=4, low_rank=4, global_transformer_nhead=4, prediction=False, manual_module_order=None, lr=0.001, batch_size=256, epochs=500, no_cuda=False, log_freq=1, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', cuda_condition=True, data_file='./data/Features/Home/reviews_Home.txt', item_size=28239, num_users=66519, mask_id=28238, log_file='outputs/Home/STOSA-Home-2-4-order-auto.txt')
===> Module Order: ['fusion', 'attention', 'filter']
{'epoch': 0, 'rec_avg_loss': '0.6884', 'rec_cur_loss': '0.5780', 'rec_avg_auc': '0.717338', 'rec_avg_pvn_loss': '0.137696'}
{'Epoch': 0, 'Recall@10': '0.0092', 'Recall@20': '0.0169', 'NDCG@10': '0.0046', 'NDCG@20': '0.0066'}
Epoch 0 duration: 49.61 seconds
49.61
{'epoch': 1, 'rec_avg_loss': '0.5170', 'rec_cur_loss': '0.5189', 'rec_avg_auc': '0.796820', 'rec_avg_pvn_loss': '0.068845'}
